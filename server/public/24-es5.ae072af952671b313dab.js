function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{aEqK:function(e,n,t){"use strict";t.r(n);var o=t("ofXK"),i=t("3Pt+"),a=t("TEn/"),r=t("tyNb"),s=t("mrSG"),c=t("tk/3"),l=t("LRne"),b=t("lJxs"),u=t("JIr8"),p=t("NIW7"),m=t("lNB8"),f=t("VOof"),d=t("w9U0"),h=t("cxbk"),g=t("fXoL"),v=["fileUpload"];function y(e,n){if(1&e&&g.Kb(0,"img",17),2&e){var t=g.Wb();g.cc("src",t.logo,g.ic)}}function M(e,n){if(1&e){var t=g.Nb();g.Mb(0,"ion-list"),g.Kb(1,"ion-item-divider",18),g.Mb(2,"ion-item",9),g.Mb(3,"ion-label"),g.Mb(4,"strong"),g.lc(5,"Actualizar imagen por:"),g.Lb(),g.Kb(6,"br"),g.lc(7),g.Lb(),g.Mb(8,"ion-buttons",19),g.Mb(9,"ion-button",20),g.Ub("click",(function(){return g.hc(t),g.Wb().deletedFile()})),g.Kb(10,"ion-icon",21),g.Lb(),g.Lb(),g.Lb(),g.Lb()}if(2&e){var o=n.$implicit;g.zb(7),g.oc(" ",o.data.name," - ",o.data.type," ")}}function k(e,n){if(1&e){var t=g.Nb();g.Mb(0,"ion-button",22),g.Ub("click",(function(){return g.hc(t),g.Wb().onClick()})),g.Mb(1,"div"),g.lc(2,"Cargar Imagen"),g.Lb(),g.Lb()}}function L(e,n){if(1&e){var t=g.Nb();g.Mb(0,"ion-button",23),g.Ub("click",(function(){return g.hc(t),g.Wb().uploadFiles()})),g.Mb(1,"div"),g.lc(2,"Actualizar Foto Empresa"),g.Lb(),g.Lb()}}var C,w,E=[{path:"",component:(C=function(){function e(n,t,o,i,a){var r=this;_classCallCheck(this,e),this.modalCtrl=n,this.storage=t,this.apiEntrena=o,this.toasCtrl=i,this.dtacompany=a,this.files=[],this.filesRendering=[],this.values={src:"",mime:"",name:""},this.logo="",this.name="",this.theme="",this.dtacompany.$color.subscribe((function(e){r.theme=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ionViewWillEnter",value:function(){this.loadDataMenu()}},{key:"loadDataMenu",value:function(){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.getLogin();case 2:(n=e.sent)&&this.apiEntrena.preferencesLoad({user:n[0].data._id},n[0].token).subscribe((function(e){console.log(e),"ok"===e.status?(t.logo=e.response.logo?"https://www.vtentrena.com/"+e.response.logo:"",t.name=e.response.nameCompany?e.response.nameCompany:"VTEntrena Application",t.theme=e.response.theme?e.response.theme:"light"):(t.logo="",t.name="VTEntrena Application",t.theme="light")}),(function(e){t.logo="",t.name="VTEntrena Application",t.theme="light"}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"uploadFile",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t,o,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.storage.getLogin();case 2:(t=n.sent)&&((o=new FormData).append("file",e.data),e.inProgress=!0,console.log(t),this.apiEntrena.uploadPreference(o,t[0].token).pipe(Object(b.a)((function(n){switch(console.log("Holaa"),n.type){case c.c.UploadProgress:e.progress=Math.round(1*n.loaded/n.total);break;case c.c.Response:return n}})),Object(u.a)((function(n){return e.inProgress=!1,Object(l.a)("".concat(e.data.name," upload failed."))}))).subscribe((function(e){"object"==typeof e&&(console.log(e.body," Respuesta"),"ok"===e.body.status?(i.logo=h.a.URL_NODE+"/"+e.body.response.logo,i.dtacompany.getDataCompany({logo:h.a.URL_NODE+"/uploads/Perfiles/"+e.body.response.logo,name:e.body.response.nameCompany?e.body.response.nameCompany:"VTEntrena Application"}),i.files=[]):i.toasCtrl.newCreatedToast("Upload failed",!1))})));case 4:case"end":return n.stop()}}),n,this)})))}},{key:"uploadFiles",value:function(){var e=this;this.fileUpload.nativeElement.value="",this.files.forEach((function(n){e.uploadFile(n)}))}},{key:"onClick",value:function(){var e=this,n=this.fileUpload.nativeElement;n.onchange=function(){for(var t=0;t<n.files.length;t++){var o=n.files[t];console.log(o,o.name),e.files.push({data:o,inProgress:!1,progress:0})}},n.click()}},{key:"deletedFile",value:function(){this.files=[]}},{key:"changeTheme",value:function(e){this.theme=e.detail.value}},{key:"save",value:function(){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.getLogin();case 2:(n=e.sent)&&this.apiEntrena.preferences({name:this.name,theme:this.theme},n[0].token).subscribe((function(e){console.log(e),"ok"===e.status?(t.toasCtrl.newCreatedToast("Datos Actualizados",!0),t.name=e.response.nameCompany?e.response.nameCompany:"VTEntrena Application",t.theme=e.response.theme?e.response.theme:"light",t.dtacompany.getDataCompany({changelogo:!0,logo:"https://www.vtentrena.com/"+e.response.logo,name:e.response.nameCompany?e.response.nameCompany:"VTEntrena Application"}),t.dtacompany.setColor(t.theme)):(t.toasCtrl.newCreatedToast("No se pudo actualizar la informaci\xf3n",!1),t.theme="light",t.name="VTEntrena Application")}),(function(e){t.toasCtrl.newCreatedToast("No se pudo actualizar la informaci\xf3n",!1),t.theme="light",t.name="VTEntrena Application"}));case 4:case"end":return e.stop()}}),e,this)})))}}]),e}(),C.\u0275fac=function(e){return new(e||C)(g.Jb(a.Y),g.Jb(f.a),g.Jb(p.a),g.Jb(d.a),g.Jb(m.a))},C.\u0275cmp=g.Db({type:C,selectors:[["app-preferences"]],viewQuery:function(e,n){var t;1&e&&g.pc(v,!0),2&e&&g.gc(t=g.Vb())&&(n.fileUpload=t.first)},decls:44,vars:6,consts:[[3,"color"],["color","light"],[2,"margin-top","10px"],["class","img","alt","",3,"src",4,"ngIf"],[4,"ngFor","ngForOf"],["class","myButton","mode","ios","color","tertiary",3,"click",4,"ngIf"],["class","myButton","mode","ios","color","success",3,"click",4,"ngIf"],["type","file","id","fileUpload","name","file","accept","image/*","multiple","false",2,"display","none"],["fileUpload",""],[1,"marginBottom"],["type","text",3,"ngModel","ngModelChange"],["value","Rojo","okText","Aceptar","cancelText","Cancelar",3,"ionChange"],["value","danger"],["value","success"],["value","warning"],["value","primary"],["expand","block","mode","ios","color","light",1,"myButton",3,"click"],["alt","",1,"img",3,"src"],["color","warning"],["slot","end"],[3,"click"],["name","trash","color","danger","slot","icon-only"],["mode","ios","color","tertiary",1,"myButton",3,"click"],["mode","ios","color","success",1,"myButton",3,"click"]],template:function(e,n){1&e&&(g.Mb(0,"ion-header"),g.Mb(1,"ion-toolbar",0),g.Mb(2,"ion-title"),g.lc(3,"Preferencias"),g.Lb(),g.Lb(),g.Lb(),g.Mb(4,"ion-content"),g.Mb(5,"ion-item-divider",1),g.Mb(6,"ion-label"),g.Mb(7,"strong"),g.lc(8,"Foto de Empresa"),g.Lb(),g.Lb(),g.Lb(),g.Mb(9,"div"),g.Mb(10,"div",2),g.kc(11,y,1,1,"img",3),g.kc(12,M,11,2,"ion-list",4),g.Mb(13,"div"),g.kc(14,k,3,0,"ion-button",5),g.kc(15,L,3,0,"ion-button",6),g.Lb(),g.Lb(),g.Kb(16,"input",7,8),g.Lb(),g.Mb(18,"ion-list"),g.Mb(19,"ion-item-divider",1),g.Mb(20,"ion-label"),g.Mb(21,"strong"),g.lc(22,"Informaci\xf3n"),g.Lb(),g.Lb(),g.Lb(),g.Mb(23,"ion-item-divider",9),g.Mb(24,"ion-label"),g.Mb(25,"strong"),g.lc(26,"Nombre de Empresa"),g.Lb(),g.Lb(),g.Mb(27,"ion-input",10),g.Ub("ngModelChange",(function(e){return n.name=e})),g.Lb(),g.Lb(),g.Mb(28,"ion-item",9),g.Mb(29,"ion-label"),g.Mb(30,"strong"),g.lc(31,"Tema Color"),g.Lb(),g.Lb(),g.Mb(32,"ion-select",11),g.Ub("ionChange",(function(e){return n.changeTheme(e)})),g.Mb(33,"ion-select-option",12),g.lc(34,"Rojo"),g.Lb(),g.Mb(35,"ion-select-option",13),g.lc(36,"Verde"),g.Lb(),g.Mb(37,"ion-select-option",14),g.lc(38,"Amarillo"),g.Lb(),g.Mb(39,"ion-select-option",15),g.lc(40,"Azul"),g.Lb(),g.Lb(),g.Lb(),g.Lb(),g.Mb(41,"ion-button",16),g.Ub("click",(function(){return n.save()})),g.Mb(42,"div"),g.lc(43,"Guardar Cambios"),g.Lb(),g.Lb(),g.Lb()),2&e&&(g.zb(1),g.cc("color",n.theme),g.zb(10),g.cc("ngIf",""!==n.logo),g.zb(1),g.cc("ngForOf",n.files),g.zb(2),g.cc("ngIf",0===n.files.length),g.zb(1),g.cc("ngIf",n.files.length>0),g.zb(12),g.cc("ngModel",n.name))},directives:[a.s,a.T,a.S,a.l,a.w,a.A,o.i,o.h,a.B,a.u,a.fb,i.c,i.d,a.v,a.L,a.eb,a.M,a.g,a.h,a.t],styles:[".img[_ngcontent-%COMP%]{width:100%;max-width:500px;text-align:center;padding:10px}"]}),C)}],T=((w=function e(){_classCallCheck(this,e)}).\u0275mod=g.Hb({type:w}),w.\u0275inj=g.Gb({factory:function(e){return new(e||w)},imports:[[r.h.forChild(E)],r.h]}),w);t.d(n,"PreferencesPageModule",(function(){return x}));var U,x=((U=function e(){_classCallCheck(this,e)}).\u0275mod=g.Hb({type:U}),U.\u0275inj=g.Gb({factory:function(e){return new(e||U)},imports:[[o.b,i.a,a.U,T]]}),U)}}]);