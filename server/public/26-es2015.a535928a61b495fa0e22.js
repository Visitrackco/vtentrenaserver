(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{KMca:function(t,n,e){"use strict";e.r(n);var i=e("ofXK"),o=e("3Pt+"),c=e("TEn/"),r=e("tyNb"),a=e("mrSG"),s=e("Rwse"),l=e("w9U0"),b=e("J07l"),d=e("fXoL");let h=(()=>{class t{transform(t,n){n=n.toLowerCase();const e=t.filter(t=>{const e=t.infoAction.name;if(t.infoAction.name=t.infoAction.name.toLowerCase(),t.infoAction.name.includes(n))return t.infoAction.name=e,t});return console.log(e,"Retorno"),e}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275pipe=d.Ib({name:"filterRepository",type:t,pure:!0}),t})();function f(t,n){1&t&&(d.Mb(0,"strong"),d.lc(1,"- Papelera"),d.Lb())}const p=function(t){return["/repository/folders",t]};function u(t,n){if(1&t&&(d.Mb(0,"ion-chip",15),d.lc(1),d.Lb()),2&t){const t=n.$implicit;d.cc("routerLink",d.fc(2,p,t.id)),d.zb(1),d.nc("",t.name," / ")}}function m(t,n){1&t&&(d.Mb(0,"h3"),d.lc(1,"A\xfan no tienes archivos en esta carpeta"),d.Lb())}function g(t,n){1&t&&(d.Mb(0,"h3"),d.lc(1,"A\xfan no tienes archivos ni carpetas en la papelera"),d.Lb())}function y(t,n){if(1&t&&(d.Mb(0,"div",16),d.kc(1,m,2,0,"h3",4),d.kc(2,g,2,0,"h3",4),d.Lb()),2&t){const t=d.Wb();d.zb(1),d.cc("ngIf","trash"!==t.parentId),d.zb(1),d.cc("ngIf","trash"===t.parentId)}}function k(t,n){if(1&t&&(d.Mb(0,"ion-label"),d.lc(1),d.Lb()),2&t){const t=d.Wb(2);d.zb(1),d.nc(" Tienes ",t.children.length," archivos en esta carpeta ")}}function M(t,n){if(1&t&&(d.Mb(0,"ion-label"),d.lc(1),d.Lb()),2&t){const t=d.Wb(2);d.zb(1),d.nc(" Tienes ",t.children.length," en la papelera ")}}function C(t,n){if(1&t){const t=d.Nb();d.Mb(0,"div",17),d.Mb(1,"ion-item-divider",18),d.kc(2,k,2,1,"ion-label",4),d.kc(3,M,2,1,"ion-label",4),d.Mb(4,"ion-chip",19),d.Ub("click",(function(){return d.hc(t),d.Wb().addChild("keys")})),d.Kb(5,"ion-icon",20),d.lc(6," Permisos"),d.Lb(),d.Lb(),d.Lb()}if(2&t){const t=d.Wb();d.zb(2),d.cc("ngIf","trash"!==t.parentId),d.zb(1),d.cc("ngIf","trash"===t.parentId)}}function L(t,n){if(1&t&&(d.Mb(0,"strong"),d.lc(1),d.Lb()),2&t){const t=d.Wb(2).$implicit;d.zb(1),d.mc(t.infoAction.name)}}function v(t,n){if(1&t&&(d.Mb(0,"ion-item"),d.Kb(1,"ion-icon",26),d.Mb(2,"ion-label"),d.kc(3,L,2,1,"strong",4),d.Kb(4,"br"),d.Lb(),d.Lb()),2&t){const t=d.Wb().$implicit;d.zb(3),d.cc("ngIf","file"===t.typeAction)}}function I(t,n){if(1&t&&(d.Mb(0,"ion-item",27),d.Kb(1,"ion-icon",28),d.Mb(2,"ion-label"),d.Mb(3,"strong"),d.lc(4),d.Lb(),d.Kb(5,"br"),d.Mb(6,"p"),d.lc(7),d.Lb(),d.Lb(),d.Lb()),2&t){const t=d.Wb().$implicit;d.cc("routerLink",d.fc(3,p,t._id)),d.zb(4),d.mc(t.infoAction.name),d.zb(3),d.mc(t.infoAction.description)}}function w(t,n){if(1&t){const t=d.Nb();d.Mb(0,"ion-item-option",29),d.Ub("click",(function(){d.hc(t);const n=d.Wb().$implicit;return d.Wb().download(n.infoAction.path,n.infoAction.name)})),d.Kb(1,"ion-icon",30),d.Lb()}}function z(t,n){if(1&t){const t=d.Nb();d.Mb(0,"ion-item-option",31),d.Ub("click",(function(){d.hc(t);const n=d.Wb().$implicit;return d.Wb().alertDelete(n._id,n.typeAction)})),d.Kb(1,"ion-icon",32),d.Lb()}}function A(t,n){if(1&t){const t=d.Nb();d.Mb(0,"ion-item-option",33),d.Ub("click",(function(){d.hc(t);const n=d.Wb().$implicit;return d.Wb().recoverChildren(n._id,n.typeAction)})),d.Kb(1,"ion-icon",34),d.Lb()}}function T(t,n){if(1&t&&(d.Mb(0,"ion-item-sliding"),d.kc(1,v,5,1,"ion-item",4),d.kc(2,I,8,5,"ion-item",21),d.Mb(3,"ion-item-options",22),d.kc(4,w,2,0,"ion-item-option",23),d.kc(5,z,2,0,"ion-item-option",24),d.kc(6,A,2,0,"ion-item-option",25),d.Lb(),d.Lb()),2&t){const t=n.$implicit,e=d.Wb();d.zb(1),d.cc("ngIf","file"===t.typeAction),d.zb(1),d.cc("ngIf","folder"===t.typeAction),d.zb(2),d.cc("ngIf","file"===t.typeAction&&"trash"!==e.parentId),d.zb(1),d.cc("ngIf","trash"!==e.parentId),d.zb(1),d.cc("ngIf","trash"===e.parentId)}}function W(t,n){if(1&t){const t=d.Nb();d.Mb(0,"ion-fab",35),d.Mb(1,"ion-fab-button",1),d.Kb(2,"ion-icon",36),d.Lb(),d.Mb(3,"ion-fab-list",37),d.Mb(4,"ion-fab-button",29),d.Ub("click",(function(){return d.hc(t),d.Wb().addChild("file")})),d.Kb(5,"ion-icon",38),d.Lb(),d.Mb(6,"ion-fab-button",29),d.Ub("click",(function(){return d.hc(t),d.Wb().addChild("folder")})),d.Kb(7,"ion-icon",39),d.Lb(),d.Lb(),d.Lb()}}const P=[{path:"",component:(()=>{class t{constructor(t,n,e,i,o,c){this.modalCtrl=t,this.activeRoute=n,this.myToast=e,this.apiService=i,this.router=o,this.alertCtrl=c,this.parentId="",this.children=[],this.textFilter="",this.listPath=[]}ngOnInit(){}ionViewWillEnter(){this.parentId=this.activeRoute.snapshot.paramMap.get("parent"),"trash"===this.parentId?this.listChildren("trash"):(this.apiService.getPathFolder(this.parentId).subscribe(t=>{"ok"===t.status&&(this.listPath=t.response)}),this.listChildren(""))}addChild(t){return Object(a.a)(this,void 0,void 0,(function*(){let n="";"file"===t?n="Subir Archivos":"folder"===t?n="Crear Carpeta":"keys"===t&&(n="\xbfQui\xe9n tiene permisos para esta carpeta?");const e=yield this.modalCtrl.create({component:s.a,componentProps:{type:t,title:n,parentId:this.parentId}});yield e.present();const i=yield e.onWillDismiss();i&&(i.data.status?(this.listChildren(""),this.myToast.newCreatedToast(i.data.message,!0)):this.myToast.newCreatedToast("No se pudo realizar la acci\xf3n",!1))}))}listChildren(t){this.apiService.getFolders(this.parentId,t).subscribe(t=>{if(console.log(t),"ok"===t.status){const n=t.response.filter(t=>"file"===t.typeAction),e=t.response.filter(t=>"folder"===t.typeAction);this.children=n,e.forEach(t=>this.children.push(t))}},()=>{this.myToast.newCreatedToast("No se pudo realizar la acci\xf3n",!1)})}listData(t){return new Promise((n,e)=>{this.apiService.getFolders(t,"").subscribe(t=>{"ok"===t.status?n({files:t.response.filter(t=>"file"===t.typeAction).length,folder:t.response.filter(t=>"folder"===t.typeAction).length}):e({error:t.err})})})}download(t,n){console.log(n),window.open("http://localhost:3000/download?path="+t+"&name="+n,"_self")}filter(t){this.textFilter=t.detail.value}alertDelete(t,n){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.listData(t);if(e){const i=yield this.alertCtrl.create({header:"Esta seguro de eliminar esta Carpeta?",message:`Dentro de ella se encuentran ${e.files} archivos y  ${e.folder} carpetas.`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Aceptar",handler:()=>{this.deleteChildren(t,n)}}]});return yield i.present()}}))}deleteChildren(t,n){const e="file"===n?"Archivo eliminado del repositorio":"Carpeta eliminada del repositorio";this.apiService.deletedFolder(t).subscribe(t=>{"ok"===t.status?(this.listChildren(""),this.myToast.newCreatedToast(e,!1)):this.myToast.newCreatedToast("No se pudo realizar la acci\xf3n",!1)},()=>{this.myToast.newCreatedToast("No se pudo realizar la acci\xf3n",!1)})}recoverChildren(t,n){const e="file"===n?"Archivo recuperado":"Carpeta recuperada";console.log(t),this.apiService.recoverFolder(t).subscribe(t=>{"ok"===t.status?(this.listChildren("trash"),this.myToast.newCreatedToast(e,!1)):this.myToast.newCreatedToast("No se pudo realizar la acci\xf3n",!1)},()=>{this.myToast.newCreatedToast("No se pudo realizar la acci\xf3n",!1)})}trash(){this.router.navigate(["repository/folders/trash"])}return(){}}return t.\u0275fac=function(n){return new(n||t)(d.Jb(c.Y),d.Jb(r.a),d.Jb(l.a),d.Jb(b.a),d.Jb(r.f),d.Jb(c.a))},t.\u0275cmp=d.Db({type:t,selectors:[["app-folders"]],decls:20,vars:9,consts:[[1,"ion-no-border"],["color","danger"],["slot","start"],["defaultHref","repository","icon","chevron-back-outline"],[4,"ngIf"],["slot","end"],[3,"click"],["name","trash-outline","slot","icon-only"],[1,"navigator"],["color","medium",3,"routerLink",4,"ngFor","ngForOf"],["mode","ios","placeholder","Buscar archivos o carpetas",3,"ionChange"],["class","menssage",4,"ngIf"],["class","calc",4,"ngIf"],[4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["color","medium",3,"routerLink"],[1,"menssage"],[1,"calc"],["color","light",1,"divider"],["color","warning","slot","end",3,"click"],["name","key-outline","slot","start"],[3,"routerLink",4,"ngIf"],["side","end"],["color","light",3,"click",4,"ngIf"],["color","danger",3,"click",4,"ngIf"],["color","secondary",3,"click",4,"ngIf"],["name","documents-outline","slot","start"],[3,"routerLink"],["name","folder","slot","start"],["color","light",3,"click"],["name","download-outline","slot","icon-only"],["color","danger",3,"click"],["name","trash","slot","icon-only"],["color","secondary",3,"click"],["name","arrow-up-outline","slot","icon-only"],["vertical","bottom","horizontal","end","slot","fixed"],["name","add-outline"],["side","top"],["name","document-attach-outline"],["name","folder-outline"]],template:function(t,n){1&t&&(d.Mb(0,"ion-header",0),d.Mb(1,"ion-toolbar",1),d.Mb(2,"ion-buttons",2),d.Kb(3,"ion-back-button",3),d.Lb(),d.Mb(4,"ion-title"),d.lc(5,"Sistema de archivos "),d.kc(6,f,2,0,"strong",4),d.Lb(),d.Mb(7,"ion-buttons",5),d.Mb(8,"ion-button",6),d.Ub("click",(function(){return n.trash()})),d.Kb(9,"ion-icon",7),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Mb(10,"ion-content"),d.Mb(11,"div",8),d.kc(12,u,2,4,"ion-chip",9),d.Lb(),d.Mb(13,"ion-searchbar",10),d.Ub("ionChange",(function(t){return n.filter(t)})),d.Lb(),d.Mb(14,"ion-list"),d.kc(15,y,3,2,"div",11),d.kc(16,C,7,2,"div",12),d.kc(17,T,7,5,"ion-item-sliding",13),d.Xb(18,"filterRepository"),d.Lb(),d.kc(19,W,8,0,"ion-fab",14),d.Lb()),2&t&&(d.zb(6),d.cc("ngIf","trash"===n.parentId),d.zb(6),d.cc("ngForOf",n.listPath),d.zb(3),d.cc("ngIf",0===n.children.length),d.zb(1),d.cc("ngIf",n.children.length>0),d.zb(1),d.cc("ngForOf",d.Yb(18,6,n.children,n.textFilter)),d.zb(2),d.cc("ngIf","trash"!==n.parentId))},directives:[c.s,c.T,c.h,c.d,c.e,c.S,i.i,c.g,c.t,c.l,i.h,c.K,c.fb,c.B,c.j,c.db,r.g,c.w,c.A,c.z,c.y,c.v,c.x,c.n,c.o,c.p],pipes:[h],styles:[".calc[_ngcontent-%COMP%], .menssage[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.menssage[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;opacity:.3}.calc[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{opacity:.7;margin-left:15px;padding-bottom:10px;border-bottom:1px solid rgba(0,0,0,.1)}ion-list[_ngcontent-%COMP%]{margin-bottom:30px}.navigator[_ngcontent-%COMP%]{width:100%;padding:5px 10px}"]}),t})()}];let x=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(n){return new(n||t)},imports:[[r.h.forChild(P)],r.h]}),t})();var K=e("iZCz"),F=e("BQi/");e.d(n,"FoldersPageModule",(function(){return O}));let O=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(n){return new(n||t)},imports:[[i.b,o.a,c.U,x,K.a,F.a]]}),t})()}}]);