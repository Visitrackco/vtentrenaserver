(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{xCeV:function(e,t,o){"use strict";o.r(t);var n=o("ofXK"),s=o("3Pt+"),i=o("TEn/"),a=o("tyNb"),r=o("mrSG"),c=o("96DK"),l=o("VOof"),b=o("J07l"),p=o("w9U0"),g=o("lNB8"),d=o("Adf6"),h=o("R0Ic"),m=o("NIW7"),u=o("fXoL"),f=o("7JkF"),M=o("e8h1");function y(e,t){1&e&&(u.Mb(0,"div"),u.Mb(1,"ion-row"),u.Mb(2,"ion-col",19),u.Kb(3,"ion-spinner",20),u.Lb(),u.Lb(),u.Mb(4,"ion-row"),u.Mb(5,"ion-col",19),u.Mb(6,"p"),u.lc(7,"Accediendo a la cuenta"),u.Lb(),u.Lb(),u.Lb(),u.Lb())}function C(e,t){if(1&e){const e=u.Nb();u.Mb(0,"div",6),u.Mb(1,"h3"),u.lc(2,"Credenciales de Usuario"),u.Lb(),u.Mb(3,"ion-list"),u.Mb(4,"ion-item",7),u.Mb(5,"ion-checkbox",8),u.Ub("ionChange",(function(t){return u.hc(e),u.Wb().changeLogin(t)})),u.Lb(),u.Mb(6,"ion-label"),u.lc(7,"Entrar como usuario Externo"),u.Lb(),u.Lb(),u.Mb(8,"ion-item",9),u.Kb(9,"ion-icon",10),u.Mb(10,"ion-input",11),u.Ub("ngModelChange",(function(t){return u.hc(e),u.Wb().login.user=t})),u.Lb(),u.Lb(),u.Mb(11,"ion-item",9),u.Kb(12,"ion-icon",12),u.Mb(13,"ion-input",13),u.Ub("ngModelChange",(function(t){return u.hc(e),u.Wb().login.password=t})),u.Lb(),u.Lb(),u.Lb(),u.Mb(14,"ion-grid",14),u.Mb(15,"ion-row",15),u.Mb(16,"ion-col",16),u.Mb(17,"ion-button",17),u.Ub("click",(function(){return u.hc(e),u.Wb().sessionInit()})),u.lc(18,"Login"),u.Lb(),u.Lb(),u.Lb(),u.kc(19,y,8,0,"div",18),u.Lb(),u.Lb()}if(2&e){const e=u.Wb();u.cc("@openClosed",void 0),u.zb(10),u.cc("ngModel",e.login.user),u.zb(3),u.cc("ngModel",e.login.password),u.zb(6),u.cc("ngIf",e.statusResponse)}}function L(e,t){1&e&&(u.Mb(0,"div"),u.Mb(1,"ion-row"),u.Mb(2,"ion-col",19),u.Kb(3,"ion-spinner",20),u.Lb(),u.Lb(),u.Mb(4,"ion-row"),u.Mb(5,"ion-col",19),u.Mb(6,"p"),u.lc(7,"Accediendo a la cuenta de entrenamiento"),u.Lb(),u.Lb(),u.Lb(),u.Lb())}function v(e,t){if(1&e){const e=u.Nb();u.Mb(0,"div",21),u.Mb(1,"h3"),u.lc(2,"Credenciales de Usuario"),u.Lb(),u.Mb(3,"ion-list"),u.Mb(4,"ion-item",9),u.Kb(5,"ion-icon",10),u.Mb(6,"ion-input",11),u.Ub("ngModelChange",(function(t){return u.hc(e),u.Wb().loginEntrena.login=t})),u.Lb(),u.Lb(),u.Mb(7,"ion-item",9),u.Kb(8,"ion-icon",12),u.Mb(9,"ion-input",13),u.Ub("ngModelChange",(function(t){return u.hc(e),u.Wb().loginEntrena.password=t})),u.Lb(),u.Lb(),u.Lb(),u.Mb(10,"ion-grid",14),u.Mb(11,"ion-row",15),u.Mb(12,"ion-col",16),u.Mb(13,"ion-button",22),u.Ub("click",(function(){return u.hc(e),u.Wb().sessionInit()})),u.lc(14,"Login"),u.Lb(),u.Lb(),u.Lb(),u.kc(15,L,8,0,"div",18),u.Lb(),u.Lb()}if(2&e){const e=u.Wb();u.cc("@openClosed",void 0),u.zb(6),u.cc("ngModel",e.loginEntrena.login),u.zb(3),u.cc("ngModel",e.loginEntrena.password),u.zb(6),u.cc("ngIf",e.statusResponse)}}const w=[{path:"",component:(()=>{class e{constructor(e,t,o,n,s,i,a,r,c,l,b,p){this.apiService=e,this.toastService=t,this.navCtrl=o,this.dataCompanyService=n,this.SQLService=s,this.storageService=i,this.myPlatform=a,this.menuCtrl=r,this.router=c,this.socket=l,this.storage=b,this.VTEntrenaApi=p,this.login={user:"",password:""},this.loginEntrena={login:"",password:""},this.typeApp="2",this.statusResponse=!1,this.plt="",this.ext=!1,this.IPAddres="",this.myPlatform.$myplatform.subscribe(e=>{this.plt=e})}ngOnInit(){}ionViewWillEnter(){this.menuCtrl.enable(!1,"menu"),this.createdCollections(),this.VTEntrenaApi.readIP().subscribe(e=>{e.ip&&(this.IPAddres=e.ip)})}createdCollections(){return Object(r.a)(this,void 0,void 0,(function*(){console.log("Holaaa");const e=yield this.storage.get("login"),t=yield this.storage.get("forms"),o=yield this.storage.get("formActive"),n=yield this.storage.get("chats");e||(yield this.storage.set("login",[])),t||(yield this.storage.set("forms",[])),o||(yield this.storage.set("formActive",[])),n||(yield this.storage.set("chats",[]))}))}changeApp(e){"1"!==e&&"2"!==e||(this.typeApp=e)}changeLogin(e){this.ext=e.detail.checked,console.log(e)}sessionInit(){if("1"===this.typeApp)this.ext?(this.statusResponse=!0,this.apiService.postLoginExte(this.login).subscribe(e=>{console.log(e),"error"===e.status?(this.statusResponse=!1,this.toastService.newCreatedToast("No se pudo iniciar sesion, intentelo mas tarde",!1)):"ok"===e.status&&""===e.response?(this.statusResponse=!1,this.toastService.newCreatedToast("Credenciales Incorrectas, compruebe su informacion",!1)):"ok"===e.status&&e.response.length>0&&(this.dataCompanyService.getDataCompany({pathLogoCompany:"https://s3.amazonaws.com/logocompanies/D0DE636B-6CED-41BB-BA27-6ED7A1AE771D.jpg",nameCompany:"Visitrack",ext:!0}),this.socket.emit("login",{ID:e.response[0].login}),this.socket.emit("welcomeExt",{CompanyID:e.response[0].idCompany,name:e.response[0].name,login:e.response[0].login,type:"exter"}),"web"===this.plt&&(this.storageService.insertUser({CompanyID:e.response[0].idCompany,name:e.response[0].name,login:e.response[0].login,type:"exter",logo:"https://s3.amazonaws.com/logocompanies/D0DE636B-6CED-41BB-BA27-6ED7A1AE771D.jpg",companyName:"Visitrack Application"}),this.menuCtrl.enable(!0,"menu"),this.toastService.newCreatedToast("Iniciando",!0).then(()=>{this.router.navigate(["/home"])})),console.log(e.response),this.statusResponse=!1)},e=>{this.statusResponse=!1,this.toastService.newCreatedToast(e,!0)})):(this.statusResponse=!0,this.apiService.postLogin(this.login).subscribe(e=>{e=JSON.parse(e),console.log(e),delete e.Password,e.password=this.login.password,e.login=this.login.user,e.name=e.FirstName+" "+e.LastName,console.log(e,"datica"),void 0===e.AccessToken?(console.log("Error ",e.errorMsg),this.statusResponse=!1,this.toastService.newCreatedToast(e.errorMsg,!1)):this.apiService.getUsersCompany({AccessToken:e.AccessToken}).subscribe(t=>{const o=(t=JSON.parse(t))[0].filter(t=>t.ID===e.UserID);e.ROLE=o[0].RoleCode,e.type="inter",this.socket.emit("login",{ID:e.UserID}),this.socket.emit("welcome",e),this.statusResponse=!1,this.dataCompanyService.getDataCompany({pathLogoCompany:e.logo,nameCompany:e.companyName,ext:!1}),"web"===this.plt&&(this.storageService.insertUser(e),this.menuCtrl.enable(!0,"menu"),this.toastService.newCreatedToast("Iniciando",!0).then(()=>{this.router.navigate(["/forms"])}))})},e=>{this.statusResponse=!1,this.toastService.newCreatedToast(e,!0)}));else if("2"===this.typeApp){const e=navigator.userAgent;let t=!1,o="";["Edg","Chrome","Safari","Firefox","Opera","MSIE","Trident"].forEach(n=>{-1===e.indexOf(n)||t||(o=n,t=!0)}),this.VTEntrenaApi.loginUser(this.loginEntrena,this.IPAddres,{name:o,agent:navigator.userAgent}).subscribe(e=>Object(r.a)(this,void 0,void 0,(function*(){console.log(e),"ok"===e.status?(e.response.typeApp="2",e.response.logo="https://s3.amazonaws.com/logocompanies/D0DE636B-6CED-41BB-BA27-6ED7A1AE771D.jpg",e.response.companyName="Visitrack Application",this.dataCompanyService.getDataCompany({pathLogoCompany:e.response.logo,nameCompany:e.response.companyName}),this.storageService.insertUser(e.response).then(()=>{this.menuCtrl.enable(!0,"menu"),this.router.navigate(["/list-my-designs"]),this.socket.emit("connectVT",e.response.data),this.dataCompanyService.getVista("3")})):this.toastService.newCreatedToast(`${e.response}`,!1)})),e=>{this.toastService.newCreatedToast(`Error session ${e}`,!1)})}}}return e.\u0275fac=function(t){return new(t||e)(u.Jb(b.a),u.Jb(p.a),u.Jb(i.Z),u.Jb(g.a),u.Jb(d.a),u.Jb(l.a),u.Jb(c.a),u.Jb(i.X),u.Jb(a.f),u.Jb(f.a),u.Jb(M.b),u.Jb(m.a))},e.\u0275cmp=u.Db({type:e,selectors:[["app-login"]],decls:8,vars:2,consts:[["color","dark"],[1,"center"],[1,"ion-padding"],[1,"contenedor","margin"],["class","web",4,"ngIf"],["class","entrena",4,"ngIf"],[1,"web"],["lines","none"],["slot","start","value","","color","primary",3,"ionChange"],["lines","none",1,"campos"],["slot","start","name","person-outline"],["type","text","placeholder","User",3,"ngModel","ngModelChange"],["slot","start","name","lock-closed-outline"],["clearOnEdit","false","type","password","placeholder","Password",3,"ngModel","ngModelChange"],["fixed",""],[1,"ion-margin-bottom"],["size","10","offset","1"],["mode","ios","shape","round","expand","block","color","primary",3,"click"],[4,"ngIf"],["size","10","offset","1",1,"center","row"],["name","crescent","color","danger"],[1,"entrena"],["mode","ios","shape","round","expand","block","color","danger",3,"click"]],template:function(e,t){1&e&&(u.Mb(0,"ion-header"),u.Mb(1,"ion-toolbar",0),u.Mb(2,"ion-title",1),u.lc(3,"App"),u.Lb(),u.Lb(),u.Lb(),u.Mb(4,"ion-content",2),u.Mb(5,"div",3),u.kc(6,C,20,4,"div",4),u.kc(7,v,16,4,"div",5),u.Lb(),u.Lb()),2&e&&(u.zb(6),u.cc("ngIf","1"===t.typeApp),u.zb(1),u.cc("ngIf","2"===t.typeApp))},directives:[i.s,i.T,i.S,i.l,n.i,i.B,i.v,i.i,i.b,i.A,i.t,i.u,i.fb,s.c,s.d,i.r,i.J,i.k,i.g,i.P],styles:[".contenedor[_ngcontent-%COMP%]{width:100%;max-width:600px}.margin[_ngcontent-%COMP%]{margin:50px auto}.contenedor[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;width:100%;opacity:.5}.campos[_ngcontent-%COMP%]{width:100%;border:1px solid rgba(0,0,0,.3);border-radius:5px;padding:5px 10px!important;margin-bottom:10px;opacity:.7}"],data:{animation:[Object(h.k)("openClosed",[Object(h.j)(":enter",[Object(h.i)({opacity:0,transform:"scale(0)"}),Object(h.e)("500ms",Object(h.i)({opacity:1,transform:"scale(1)"}))]),Object(h.j)(":leave",[Object(h.i)({opacity:1,transform:"scale(1)"}),Object(h.e)("0ms",Object(h.i)({opacity:0,transform:"scale(0)"}))])])]}}),e})()}];let A=(()=>{class e{}return e.\u0275mod=u.Hb({type:e}),e.\u0275inj=u.Gb({factory:function(t){return new(t||e)},imports:[[a.h.forChild(w)],a.h]}),e})();o.d(t,"LoginPageModule",(function(){return k}));let k=(()=>{class e{}return e.\u0275mod=u.Hb({type:e}),e.\u0275inj=u.Gb({factory:function(t){return new(t||e)},imports:[[n.b,s.a,i.U,A]]}),e})()}}]);