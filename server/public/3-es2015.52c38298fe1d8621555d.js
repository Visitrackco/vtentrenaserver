(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{Rwse:function(e,t,o){"use strict";var i=o("mrSG"),s=o("VOof"),n=o("J07l"),r=o("w9U0"),a=o("AytR"),c=o("tk/3"),l=o("fXoL");let b=(()=>{class e{constructor(e){this.http=e}upload(e,t,o,i){const s={headers:new c.d({"x-company":t,"x-type":o,"x-parent":i}),reportProgress:!0,observe:"events"};return this.http.post(`${a.a.URL_NODE}/folders`,e,s)}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a))},e.\u0275prov=l.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=o("lJxs"),p=o("JIr8"),u=o("LRne"),h=o("TEn/"),g=o("ofXK"),f=o("3Pt+");let m=(()=>{class e{transform(e,t,o){return console.log(o,e,t),t=t.toLocaleLowerCase(),e.forEach(e=>{o.find(t=>t===e.ID)&&(e.checked=!0)}),""===t?e:e=e.filter(e=>{if((e.name?e.name.toLowerCase():e.Name.toLowerCase()).includes(t))return e})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=l.Ib({name:"filterUserRepository",type:e,pure:!0}),e})();o.d(t,"a",(function(){return I}));const y=["fileUpload"];function M(e,t){if(1&e&&(l.Mb(0,"li"),l.Kb(1,"span",10),l.Kb(2,"ion-progress-bar",11),l.Lb()),2&e){const e=t.$implicit;l.zb(2),l.cc("value",e.progress)}}function L(e,t){if(1&e){const e=l.Nb();l.Mb(0,"div",4),l.Mb(1,"div",5),l.Mb(2,"div"),l.Mb(3,"ul"),l.kc(4,M,3,1,"li",6),l.Lb(),l.Lb(),l.Mb(5,"div"),l.Mb(6,"button",7),l.Ub("click",(function(){return l.hc(e),l.Wb(2).onClick()})),l.Mb(7,"div"),l.lc(8,"Subir Archivos"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Kb(9,"input",8,9),l.Lb()}if(2&e){const e=l.Wb(2);l.zb(4),l.cc("ngForOf",e.files)}}function C(e,t){if(1&e){const e=l.Nb();l.Mb(0,"ion-grid"),l.Mb(1,"ion-row"),l.Mb(2,"ion-col",12),l.Mb(3,"ion-input",13),l.Ub("ngModelChange",(function(t){return l.hc(e),l.Wb(2).folders.name=t})),l.Lb(),l.Lb(),l.Lb(),l.Mb(4,"ion-row"),l.Mb(5,"ion-col",12),l.Mb(6,"ion-textarea",14),l.Ub("ngModelChange",(function(t){return l.hc(e),l.Wb(2).folders.description=t})),l.Lb(),l.Lb(),l.Lb(),l.Mb(7,"ion-row"),l.Mb(8,"ion-col",15),l.Mb(9,"ion-button",16),l.Ub("click",(function(){return l.hc(e),l.Wb(2).cancelModal()})),l.lc(10,"CANCELAR"),l.Lb(),l.Lb(),l.Mb(11,"ion-col",15),l.Mb(12,"ion-button",17),l.Ub("click",(function(){return l.hc(e),l.Wb(2).saveFolder()})),l.lc(13,"CREAR"),l.Lb(),l.Lb(),l.Lb(),l.Lb()}if(2&e){const e=l.Wb(2);l.zb(3),l.cc("ngModel",e.folders.name),l.zb(3),l.cc("ngModel",e.folders.description)}}function v(e,t){if(1&e&&(l.Mb(0,"ion-content"),l.kc(1,L,11,1,"div",3),l.kc(2,C,14,2,"ion-grid",2),l.Lb()),2&e){const e=l.Wb();l.zb(1),l.cc("ngIf","file"===e.type),l.zb(1),l.cc("ngIf","folder"===e.type)}}function k(e,t){if(1&e){const e=l.Nb();l.Mb(0,"ion-content"),l.Mb(1,"ion-grid"),l.Mb(2,"ion-row"),l.Mb(3,"ion-col",12),l.Mb(4,"ion-input",18),l.Ub("ngModelChange",(function(t){return l.hc(e),l.Wb().category.name=t})),l.Lb(),l.Lb(),l.Lb(),l.Mb(5,"ion-row"),l.Mb(6,"ion-col",12),l.Mb(7,"ion-textarea",19),l.Ub("ngModelChange",(function(t){return l.hc(e),l.Wb().category.description=t})),l.Lb(),l.Lb(),l.Lb(),l.Mb(8,"ion-row"),l.Mb(9,"ion-col",15),l.Mb(10,"ion-button",16),l.Ub("click",(function(){return l.hc(e),l.Wb().cancelModal()})),l.lc(11,"CANCELAR"),l.Lb(),l.Lb(),l.Mb(12,"ion-col",15),l.Mb(13,"ion-button",17),l.Ub("click",(function(){return l.hc(e),l.Wb().saveCategory()})),l.lc(14,"CREAR"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Lb()}if(2&e){const e=l.Wb();l.zb(4),l.cc("ngModel",e.category.name),l.zb(3),l.cc("ngModel",e.category.description)}}function w(e,t){if(1&e){const e=l.Nb();l.Mb(0,"ion-item"),l.Mb(1,"ion-checkbox",24),l.Ub("ionChange",(function(t){return l.hc(e),l.Wb(2).selection(t)})),l.Lb(),l.Mb(2,"ion-label"),l.Mb(3,"strong"),l.lc(4),l.Lb(),l.Kb(5,"br"),l.Mb(6,"p"),l.lc(7,"Brindarle permisos para esta carpeta"),l.Lb(),l.Lb(),l.Lb()}if(2&e){const e=t.$implicit;l.zb(1),l.dc("value",e.ID),l.cc("checked",e.checked),l.zb(3),l.mc(e.Name)}}function x(e,t){if(1&e){const e=l.Nb();l.Mb(0,"ion-item"),l.Mb(1,"ion-checkbox",24),l.Ub("ionChange",(function(t){return l.hc(e),l.Wb(2).selection(t)})),l.Lb(),l.Mb(2,"ion-label"),l.Mb(3,"strong"),l.lc(4),l.Lb(),l.Kb(5,"br"),l.Mb(6,"p"),l.lc(7,"Brindarle permisos para esta carpeta"),l.Lb(),l.Lb(),l.Lb()}if(2&e){const e=t.$implicit;l.zb(1),l.dc("value",e.ID),l.cc("checked",e.checked),l.zb(3),l.mc(e.name)}}function U(e,t){if(1&e){const e=l.Nb();l.Mb(0,"ion-content"),l.Mb(1,"ion-list"),l.Mb(2,"ion-item",20),l.Mb(3,"ion-searchbar",21),l.Ub("ionChange",(function(t){return l.hc(e),l.Wb().filterText(t)})),l.Lb(),l.Lb(),l.Mb(4,"ion-slides",22),l.Mb(5,"ion-slide"),l.Mb(6,"ion-item-divider",23),l.Mb(7,"h4"),l.lc(8,"Usuario de mi empresa"),l.Lb(),l.Lb(),l.kc(9,w,8,3,"ion-item",6),l.Xb(10,"filterUserRepository"),l.Lb(),l.Mb(11,"ion-slide"),l.Mb(12,"ion-item-divider",23),l.Mb(13,"h4"),l.lc(14,"Clientes de mi Empresa"),l.Lb(),l.Lb(),l.kc(15,x,8,3,"ion-item",6),l.Xb(16,"filterUserRepository"),l.Lb(),l.Lb(),l.Lb(),l.Lb()}if(2&e){const e=l.Wb();l.zb(9),l.cc("ngForOf",l.Zb(10,2,e.users,e.textFilter,e.listPermiss)),l.zb(6),l.cc("ngForOf",l.Zb(16,6,e.customers,e.textFilter,e.listPermiss))}}function T(e,t){if(1&e){const e=l.Nb();l.Mb(0,"ion-footer"),l.Mb(1,"ion-toolbar",23),l.Mb(2,"ion-buttons",25),l.Mb(3,"ion-button",26),l.Ub("click",(function(){return l.hc(e),l.Wb().savePermiss()})),l.Kb(4,"ion-icon",27),l.Lb(),l.Lb(),l.Lb(),l.Lb()}}let I=(()=>{class e{constructor(e,t,o,i,s){this.storage=e,this.modalCtrl=t,this.apiService=o,this.myToast=i,this.uploadService=s,this.category={name:"",description:"",company:""},this.folders={name:"",description:"",parent:""},this.users=[],this.customers=[],this.usersSelect=[],this.customer={name:"",login:"",clave:"",company:"",userID:""},this.textFilter="",this.files=[],this.count=0}ngOnInit(){}ionViewWillEnter(){return Object(i.a)(this,void 0,void 0,(function*(){this.initModal()}))}initModal(){return Object(i.a)(this,void 0,void 0,(function*(){if("permiss"===this.type){this.usersSelect=this.listPermiss;const e=yield this.storage.getLogin();e&&(console.log(e[0]),this.apiService.getCustomersCompany(e[0].CompanyID).subscribe(e=>{"ok"===e.status&&(e.response.length>0&&e.response.forEach(e=>{e.ID=e.login,this.customers.push(e)}),this.customers=e.response)}),this.apiService.getUsersCompany({AccessToken:e[0].AccessToken}).subscribe(t=>{t=JSON.parse(t),console.log(t),this.users=t[0],this.users=this.users.filter(t=>t.ID!==e[0].UserID)}))}else"alter"===this.type&&(console.log(this.categoryDatAlter,"iloves"),this.category.name=this.categoryDatAlter.name,this.category.description=this.categoryDatAlter.description)}))}selection(e){e.detail.checked?this.usersSelect.push(e.detail.value):this.usersSelect=this.usersSelect.filter(t=>t!==e.detail.value),console.log(this.usersSelect)}savePermiss(){this.apiService.alterPermiss({idCategory:this.idCategory,listPermiss:this.usersSelect}).subscribe(e=>{console.log(e),"ok"===e.status?this.myToast.newCreatedToast("Permisos actualizados para esta categoria",!0):this.myToast.newCreatedToast("No se pudo actualizar los permisos, intentelo mas tarde",!1),this.cancelModal()})}filterText(e){this.textFilter=e.detail.value}uploadFile(e){return Object(i.a)(this,void 0,void 0,(function*(){const t=yield this.storage.getLogin();if(t){const o=new FormData;o.append("archivo",e.data),e.inProgress=!0,this.uploadService.upload(o,t[0].CompanyID,"file",this.parentId).pipe(Object(d.a)(t=>{switch(t.type){case c.c.UploadProgress:e.progress=Math.round(1*t.loaded/t.total);break;case c.c.Response:return t}}),Object(p.a)(t=>(e.inProgress=!1,Object(u.a)(`${e.data.name} upload failed.`)))).subscribe(e=>{"object"==typeof e&&(console.log(e.body," Respuesta"),"ok"===e.body.status?(this.count--,0===this.count&&this.modalCtrl.dismiss({status:!0,message:"Archivo subido con \xe9xito"})):this.modalCtrl.dismiss({status:!1}))})}}))}uploadFiles(){this.count=this.files.length,this.fileUpload.nativeElement.value="",this.files.forEach(e=>{this.uploadFile(e)})}onClick(){const e=this.fileUpload.nativeElement;e.onchange=()=>{for(let t=0;t<e.files.length;t++)this.files.push({data:e.files[t],inProgress:!1,progress:0});this.uploadFiles()},e.click()}saveCategory(){return Object(i.a)(this,void 0,void 0,(function*(){const e=yield this.storage.getLogin();e&&("category"===this.type?(this.category.company=e[0].CompanyID,this.category.userID="inter"===e[0].type?e[0].UserID:e[0].login,this.category.listPermiss="inter"===e[0].type?[e[0].UserID]:[e[0].login],console.log(this.category),this.apiService.createdCategory(this.category).subscribe(e=>{console.log(e),e.status?(this.modalCtrl.dismiss({st:!0}),this.myToast.newCreatedToast("Categoria creada correctamente ",!0)):this.myToast.newCreatedToast("Error al crear la categoria ",!1)},e=>{this.myToast.newCreatedToast("Error al crear la categoria ",!1)})):"alter"===this.type&&this.apiService.alterCategory({idCategory:this.categoryDatAlter._id,name:this.category.name,description:this.category.description}).subscribe(e=>{console.log(e),"ok"===e.status?(this.modalCtrl.dismiss({st:!0}),this.myToast.newCreatedToast("Categoria editada correctamente ",!0)):this.myToast.newCreatedToast("No se pudo editar la categoria, intentelo m\xe1s tarde ",!1)},e=>{this.myToast.newCreatedToast("No se pudo editar la categoria, intentelo m\xe1s tarde ",!1)}))}))}saveFolder(){return Object(i.a)(this,void 0,void 0,(function*(){console.log(this.folders),this.folders.parent=this.parentId,this.apiService.createdFolder(this.folders).subscribe(e=>{console.log(e),e.status?(this.modalCtrl.dismiss({status:!0,message:"Carpeta creada con \xe9xito"}),this.myToast.newCreatedToast("Carpeta creada correctamente ",!0)):(this.modalCtrl.dismiss({status:!1}),this.myToast.newCreatedToast("Error al crear la carpeta ",!1))},e=>{this.myToast.newCreatedToast("Error al crear la carpeta ",!1)})}))}cancelModal(){this.modalCtrl.dismiss({status:!1})}}return e.\u0275fac=function(t){return new(t||e)(l.Jb(s.a),l.Jb(h.Y),l.Jb(n.a),l.Jb(r.a),l.Jb(b))},e.\u0275cmp=l.Db({type:e,selectors:[["app-category"]],viewQuery:function(e,t){var o;1&e&&l.pc(y,!0),2&e&&l.gc(o=l.Vb())&&(t.fileUpload=o.first)},inputs:{type:"type",listPermiss:"listPermiss",idCategory:"idCategory",title:"title",parentId:"parentId",categoryDatAlter:"categoryDatAlter"},decls:8,vars:5,consts:[[1,"ion-no-border"],["color","danger"],[4,"ngIf"],["style","text-align:center; margin-top: 100px; ",4,"ngIf"],[2,"text-align","center","margin-top","100px"],[2,"margin-top","10px"],[4,"ngFor","ngForOf"],[1,"myButton",3,"click"],["type","file","id","fileUpload","name","archivo","multiple","multiple",2,"display","none"],["fileUpload",""],["id","file-label"],["color","primary",3,"value"],["size","10","offset","1"],["type","text","placeholder","Nombre de la carpeta",1,"campo",3,"ngModel","ngModelChange"],["rows","5","placeholder","Descripci\xf3n de la carpeta",1,"campo",3,"ngModel","ngModelChange"],["size","4","offset","1"],["expand","block","color","light","mode","ios","shapw","round",3,"click"],["expand","block","color","danger","mode","ios","shapw","round",3,"click"],["type","text","placeholder","Nombre de la categoria",1,"campo",3,"ngModel","ngModelChange"],["rows","5","placeholder","Descripci\xf3n de la categoria",1,"campo",3,"ngModel","ngModelChange"],["lines","none"],["placeholder","Buscar Usuario","mode","ios",3,"ionChange"],[1,"slides"],["color","light"],["slot","start","color","danger",3,"checked","value","ionChange"],["slot","end"],[3,"click"],["name","add-outline","slot","icon-only"]],template:function(e,t){1&e&&(l.Mb(0,"ion-header",0),l.Mb(1,"ion-toolbar",1),l.Mb(2,"ion-title"),l.lc(3),l.Lb(),l.Lb(),l.Lb(),l.kc(4,v,3,2,"ion-content",2),l.kc(5,k,15,2,"ion-content",2),l.kc(6,U,17,10,"ion-content",2),l.kc(7,T,5,0,"ion-footer",2)),2&e&&(l.zb(3),l.mc(t.title),l.zb(1),l.cc("ngIf","file"===t.type||"folder"===t.type),l.zb(1),l.cc("ngIf","category"===t.type||"alter"===t.type),l.zb(1),l.cc("ngIf","permiss"===t.type),l.zb(1),l.cc("ngIf","permiss"===t.type))},directives:[h.s,h.T,h.S,g.i,h.l,g.h,h.D,h.r,h.J,h.k,h.u,h.fb,f.c,f.d,h.R,h.g,h.B,h.v,h.K,h.O,h.N,h.w,h.i,h.b,h.A,h.q,h.h,h.t],pipes:[m],styles:[".campo[_ngcontent-%COMP%]{width:100%;padding:5px 10px;border:1px solid rgba(0,0,0,.1);margin-bottom:10px;border-radius:10px;background:#f3f3f3}.myButton[_ngcontent-%COMP%]{width:80%;padding:10px;background:#f1f1f1;border:1px solid rgba(0,0,0,.1)}.slides[_ngcontent-%COMP%]{width:100%;min-height:100%;height:auto}.slides[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.slides[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}"]}),e})()},iZCz:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var i=o("ofXK"),s=o("3Pt+"),n=o("TEn/"),r=o("BQi/"),a=o("fXoL");let c=(()=>{class e{}return e.\u0275mod=a.Hb({type:e}),e.\u0275inj=a.Gb({factory:function(t){return new(t||e)},imports:[[i.b,s.a,n.U,r.a]]}),e})()}}]);