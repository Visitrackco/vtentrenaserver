{"version":3,"file":"src_app_Pages_Entrena_comments_comments_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;AAAyC;AACc;AAER;AAE/C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,wDAAY;KACxB;CACF,CAAC;IAMW,yBAAyB,SAAzB,yBAAyB;;AAAzB,yBAAyB;IAJrC,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,yDAAY,CAAC;KACxB,CAAC;GACW,yBAAyB;AAAA;;;;;;;;;;;;;;;;;;;;;;;AChBG;AACM;AACF;AAEA;AAEyB;AAEvB;IAWlC,kBAAkB,SAAlB,kBAAkB;;AAAlB,kBAAkB;IAT9B,uDAAQ,CAAC;QACR,OAAO,EAAE;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,+EAAyB;SAC1B;QACD,YAAY,EAAE,CAAC,wDAAY,CAAC;KAC7B,CAAC;GACW,kBAAkB;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBmB;AACD;AACA;AAC2B;AACD;AACK;AACR;IAO3D,YAAY,SAAZ,YAAY;IASvB,YACU,SAA0B,EAC1B,OAA0B,EAC1B,UAA6B,EAC7B,QAAsB,EACtB,MAAsB,EACtB,UAA+B;QAL/B,cAAS,GAAT,SAAS,CAAiB;QAC1B,YAAO,GAAP,OAAO,CAAmB;QAC1B,eAAU,GAAV,UAAU,CAAmB;QAC7B,aAAQ,GAAR,QAAQ,CAAc;QACtB,WAAM,GAAN,MAAM,CAAgB;QACtB,eAAU,GAAV,UAAU,CAAqB;QAbzC,UAAK,GAAG,EAAE,CAAC;QACX,YAAO,GAAG,EAAE,CAAC;QAEb,aAAQ,GAAG,EAAE,CAAC;QACd,SAAI,GAAG,EAAE,CAAC;QACV,eAAU,GAAG,EAAE,CAAC;QAChB,kBAAa,GAAG,EAAE,CAAC;QASjB,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE;YACzC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACrB,CAAC,CAAC;IACJ,CAAC;IAED,QAAQ;IACR,CAAC;IAED,gBAAgB;QAEd,IAAI,CAAC,WAAW,EAAE,CAAC;IAErB,CAAC;IAEK,WAAW;;YAEf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;YAE5C,IAAI,KAAK,EAAE;gBAET,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;gBAE/B,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,cAAc,EAAE;oBAC1C,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,EAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,IAAS,EAAE,EAAE;wBACrH,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;wBACjB,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,EAAE;4BAExB,IAAI,IAAI,GAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;4BAEjC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAO,EAAE,EAAE,EAAE,CAAC;gCAClC,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;oCAE9B,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,EAAC,aAAa,EAAE,EAAE,CAAC,GAAG,EAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,GAAQ,EAAE,EAAE;wCAChG,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,WAAW,CAAC;wCAC7B,IAAI,GAAG,CAAC,MAAM,KAAK,IAAI,EAAE;4CAEvB,EAAE,CAAC,OAAO,GAAG,GAAG,CAAC,QAAQ,CAAC;yCAC3B;6CAAM;4CACL,EAAE,CAAC,OAAO,GAAG,EAAE,CAAC;yCACjB;wCACD,OAAO,CAAC,IAAI,CAAC,CAAC;oCAClB,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;wCACT,EAAE,CAAC,OAAO,GAAG,EAAE,CAAC;wCAChB,OAAO,CAAC,IAAI,CAAC,CAAC;oCAChB,CAAC,CAAC,CAAC;gCAEH,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;oCACT,IAAI,GAAI,IAAI,GAAG,CAAC,CAAC;oCAGjB,IAAI,IAAI,KAAK,CAAC,EAAE;wCACd,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;qCAC/B;gCACL,CAAC,CAAC,CAAC;4BACL,CAAC,EAAC,CAAC;yBACJ;6BAAM;4BACL,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,oCAAoC,EAAE,KAAK,CAAC,CAAC;yBAC5E;oBACL,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;wBACT,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,oCAAoC,EAAE,KAAK,CAAC,CAAC;oBAC7E,CAAC,CAAC;iBACH;qBAAM;oBACL,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,EAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,IAAS,EAAE,EAAE;wBAC1H,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;wBACjB,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,EAAE;4BACxB,IAAI,IAAI,GAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;4BAEjC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAO,EAAE,EAAE,EAAE,CAAC;gCAClC,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;oCAE9B,IAAI,CAAC,UAAU,CAAC,mBAAmB,CAAC,EAAC,aAAa,EAAE,EAAE,CAAC,GAAG,EAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,GAAQ,EAAE,EAAE;wCAChG,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,WAAW,CAAC;wCAC7B,IAAI,GAAG,CAAC,MAAM,KAAK,IAAI,EAAE;4CAEvB,EAAE,CAAC,OAAO,GAAG,GAAG,CAAC,QAAQ,CAAC;yCAC3B;6CAAM;4CACL,EAAE,CAAC,OAAO,GAAG,EAAE,CAAC;yCACjB;wCAED,OAAO,CAAC,IAAI,CAAC,CAAC;oCAClB,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;wCACT,EAAE,CAAC,OAAO,GAAG,EAAE,CAAC;wCAChB,OAAO,CAAC,IAAI,CAAC,CAAC;oCAChB,CAAC,CAAC,CAAC;gCAEH,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;oCACT,IAAI,GAAI,IAAI,GAAG,CAAC,CAAC;oCAGjB,IAAI,IAAI,KAAK,CAAC,EAAE;wCACd,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;qCAC/B;gCACL,CAAC,CAAC,CAAC;4BACL,CAAC,EAAC,CAAC;yBACJ;6BAAM;4BACL,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,oCAAoC,EAAE,KAAK,CAAC,CAAC;yBAC5E;oBACL,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;wBACT,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,oCAAoC,EAAE,KAAK,CAAC,CAAC;oBAC7E,CAAC,CAAC;iBACH;aAEF;QAEH,CAAC;KAAA;IAEK,aAAa;;YAEjB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;YAE5C,IAAI,KAAK,EAAE;gBACT,2CAA2C;gBAC3C,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,IAAS,EAAE,EAAE;oBACzI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;oBACjB,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,EAAE;wBACxB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;wBACjC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;qBAEzD;yBAAM;wBACL,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;qBACxE;gBACL,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;oBACP,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;gBAC3E,CAAC,CAAC;aACH;QAEH,CAAC;KAAA;IAEK,aAAa,CAAC,OAAO,EAAE,CAAC;;YAC5B,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;YACpC,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC;QACnC,CAAC;KAAA;IAGD,MAAM;QACJ,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IAC1B,CAAC;IAGK,qBAAqB;;YAEzB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;YAE5C,IAAI,KAAK,EAAE;gBACT,2CAA2C;gBAC3C,IAAI,CAAC,UAAU,CAAC,sBAAsB,CAAC,EAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,IAAS,EAAE,EAAE;oBACzI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;oBACjB,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,EAAE;wBACxB,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,aAAa,CAAC;wBAC5E,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;wBACjD,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;wBACzD,IAAI,CAAC,MAAM,EAAE,CAAC;qBACb;yBAAM;wBACL,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;qBACxE;gBACL,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;oBACP,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;gBAC3E,CAAC,CAAC;aACH;QAEH,CAAC;KAAA;;;;;;;;;;AAlLU,YAAY;IALxB,wDAAS,CAAC;QACT,QAAQ,EAAE,cAAc;QACxB,qEAAmC;;KAEpC,CAAC;GACW,YAAY;AAAA","sources":["./src/app/Pages/Entrena/comments/comments-routing.module.ts","./src/app/Pages/Entrena/comments/comments.module.ts","./src/app/Pages/Entrena/comments/comments.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CommentsPage } from './comments.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CommentsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CommentsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CommentsPageRoutingModule } from './comments-routing.module';\n\nimport { CommentsPage } from './comments.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CommentsPageRoutingModule\n  ],\n  declarations: [CommentsPage]\n})\nexport class CommentsPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { ModalController } from '@ionic/angular';\nimport { ApiEntrenaService } from 'src/app/Services/Api/ApiEntrena.service';\nimport { DataComparnyService } from 'src/app/Services/dataCompany.service';\nimport { StorageWebService } from 'src/app/Services/Storage/StorageWeb.service';\nimport { ToastService } from 'src/app/Services/Utilities/Toast.service';\n\n@Component({\n  selector: 'app-comments',\n  templateUrl: './comments.page.html',\n  styleUrls: ['./comments.page.scss'],\n})\nexport class CommentsPage implements OnInit {\n\n  color = '';\n  comment = '';\n\n  comments = [];\n  role = '';\n  userRespon = '';\n  commentParent = '';\n  constructor(\n    private modalCtrl: ModalController,\n    private storage: StorageWebService,\n    private apiEntrena: ApiEntrenaService,\n    private toasCtrl: ToastService,\n    private active: ActivatedRoute,\n    private dtacompany: DataComparnyService\n  ) { \n    this.dtacompany.$color.subscribe((color) => {\n      this.color = color;\n    })\n  }\n\n  ngOnInit() {\n  }\n\n  ionViewWillEnter(){\n\n    this.getComments();\n   \n  }\n\n  async getComments( ) {\n\n    const login = await this.storage.getLogin();\n\n    if (login) {\n\n      this.role = login[0].data.role;\n\n      if (login[0].data.ro9le === 'USER_ENTRENA') {\n        this.apiEntrena.getComments({desing: this.active.snapshot.paramMap.get('id')}, login[0].token).subscribe((data: any) => {\n          console.log(data)\n          if (data.status === 'ok') {\n\n            let cont  = data.response.length;\n\n            data.response.forEach(async (it) => {\n              new Promise((resolve, reject) => {\n\n                this.apiEntrena.getCommentChildrens({commentParent: it._id}, login[0].token).subscribe((res: any) => {\n                    console.log(res, 'respuesta')\n                    if (res.status === 'ok') {\n\n                      it.answers = res.response;\n                    } else {\n                      it.answers = [];\n                    }\n                    resolve(true);\n                }, (err) => {\n                  it.answers = [];\n                  resolve(true);\n                });\n  \n                }).then(() => {\n                    cont  = cont - 1;\n\n\n                    if (cont === 0) {\n                      this.comments = data.response;\n                    }\n                });\n              });\n            } else {\n              this.toasCtrl.newCreatedToast('No se pudo obtener los comentarios', false);\n            }\n        }, (err) => {\n          this.toasCtrl.newCreatedToast('No se pudo obtener los comentarios', false);\n        })\n      } else {\n        this.apiEntrena.getCommentsAdmin({desing: this.active.snapshot.paramMap.get('id')}, login[0].token).subscribe((data: any) => {\n          console.log(data)\n          if (data.status === 'ok') {\n            let cont  = data.response.length;\n\n            data.response.forEach(async (it) => {\n              new Promise((resolve, reject) => {\n\n                this.apiEntrena.getCommentChildrens({commentParent: it._id}, login[0].token).subscribe((res: any) => {\n                    console.log(res, 'respuesta')\n                    if (res.status === 'ok') {\n\n                      it.answers = res.response;\n                    } else {\n                      it.answers = [];\n                    }\n                   \n                    resolve(true);\n                }, (err) => {\n                  it.answers = [];\n                  resolve(true);\n                });\n  \n                }).then(() => {\n                    cont  = cont - 1;\n\n\n                    if (cont === 0) {\n                      this.comments = data.response;\n                    }\n                });\n              });\n            } else {\n              this.toasCtrl.newCreatedToast('No se pudo obtener los comentarios', false);\n            }\n        }, (err) => {\n          this.toasCtrl.newCreatedToast('No se pudo obtener los comentarios', false);\n        })\n      }\n     \n    }\n\n  }\n\n  async createComment( ) {\n\n    const login = await this.storage.getLogin();\n\n    if (login) {\n      // tslint:disable-next-line:max-line-length\n      this.apiEntrena.comments({comment: this.comment, desing: this.active.snapshot.paramMap.get('id')}, login[0].token).subscribe((data: any) => {\n        console.log(data)\n        if (data.status === 'ok') {\n          this.comments.push(data.response)\n          this.toasCtrl.newCreatedToast('Comentario enviado', true);\n            \n          } else {\n            this.toasCtrl.newCreatedToast('No se pudo crear el comentario', false);\n          }\n      }, (err) => {\n          this.toasCtrl.newCreatedToast('No se pudo crear el comentario', false);\n      })\n    }\n\n  }\n\n  async answerComment(comment, i) {\n    this.userRespon = comment.user.name;\n    this.commentParent = comment._id;\n  }\n\n\n  cancel() {\n    this.userRespon = '';\n    this.commentParent = '';\n  }\n\n\n  async createCommentChildren(  ) {\n\n    const login = await this.storage.getLogin();\n\n    if (login) {\n      // tslint:disable-next-line:max-line-length\n      this.apiEntrena.createCommentChildrens({commentParent: this.commentParent, comment: this.comment}, login[0].token).subscribe((data: any) => {\n        console.log(data)\n        if (data.status === 'ok') {\n          const index = this.comments.findIndex((it) => it._id === this.commentParent)\n          this.comments[index].answers.push(data.response);\n          this.toasCtrl.newCreatedToast('Respuesta enviada', true);\n          this.cancel();\n          } else {\n            this.toasCtrl.newCreatedToast('No se pudo crear el comentario', false);\n          }\n      }, (err) => {\n          this.toasCtrl.newCreatedToast('No se pudo crear el comentario', false);\n      })\n    }\n\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}