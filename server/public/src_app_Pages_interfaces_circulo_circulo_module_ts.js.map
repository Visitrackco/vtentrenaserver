{"version":3,"file":"src_app_Pages_interfaces_circulo_circulo_module_ts.js","mappings":"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","sources":["./src/app/Pages/interfaces/circulo/circulo-routing.module.ts","./src/app/Pages/interfaces/circulo/circulo.module.ts","./src/app/Pages/interfaces/circulo/circulo.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CirculoPage } from './circulo.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CirculoPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CirculoPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CirculoPageRoutingModule } from './circulo-routing.module';\n\nimport { CirculoPage } from './circulo.page';\nimport { PipesModule } from 'src/app/Pipes/pipes.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CirculoPageRoutingModule,\n    PipesModule\n  ],\n  declarations: [CirculoPage]\n})\nexport class CirculoPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { ApiService } from 'src/app/Services/Api/Api.service';\nimport { StorageWebService } from 'src/app/Services/Storage/StorageWeb.service';\nimport { ToastService } from 'src/app/Services/Utilities/Toast.service';\nimport * as moment from 'moment-timezone';\nimport { PopoverController } from '@ionic/angular';\nimport { CirculocerradoComponent } from 'src/app/components/circulocerrado/circulocerrado.component';\n\n@Component({\n  selector: 'app-circulo',\n  templateUrl: './circulo.page.html',\n  styleUrls: ['./circulo.page.scss'],\n})\nexport class CirculoPage implements OnInit {\n\n\n  login = '';\n  password = '';\n\n  form;\n  interface;\n\n  load = true;\n  activitiesList = [];\n\n  tkn = '';\n  clientes = [];\n\n  desde = '';\n  hasta = '';\n\n  user;\n\n  constructor(\n    private storage: StorageWebService,\n    private toast: ToastService,\n    private route: ActivatedRoute,\n    private api: ApiService,\n    private popover: PopoverController\n  ) { }\n\n  ngOnInit() {\n\n  }\n\n  ionViewWillEnter() {\n    this.route.queryParams.subscribe(async (param) => {\n      this.load = false;\n      console.log(param);\n      this.tkn = param.accesstoken;\n\n      this.getLogin()\n    })\n\n    \n  }\n\n   locs() {\n    return new Promise((resolve, reject) => {\n      this.api.getLocs({\n        AccessToken: this.tkn,\n        LocationTypeID: \"A8C8259D-35A8-4E8F-8B48-C399BFBDBF68\"\n      }).subscribe((data : any) => {\n        resolve(data)\n      }, () => resolve(false), () => this.load = true) \n    })\n  }\n\n\n  async getLogin() {\n\n    const rs: any = await this.locs();\n\n    console.log(rs)\n\n    if (rs) {\n\n      this.clientes = rs;\n      const login = await this.storage.getLoginInterface();\n      if(login.length > 0) {\n        this.user = login[0].loc.Name;\n        this.interface = true;\n      } else {\n        this.form = true;\n      }\n      console.log(login, 'LOGIN')\n\n    } else {\n      this.toast.newCreatedToast('No se pudo completar la craga de la inetrfaz, inténtelo nuevamente(recargue la página)', false)\n    }\n\n   \n\n  }\n\n  async eliminar(event) {\n    const popover = await this.popover.create({\n      component: CirculocerradoComponent,\n      event: event,\n      showBackdrop: false\n    })\n\n    await popover.present();\n\n    const rs = await popover.onWillDismiss();\n\n    if (rs.data) {\n      if (rs.data == 1) {\n        this.storage.deletelogininterfaces();\n        this.form = true;\n        this.interface = false;\n        this.desde = '';\n        this.hasta = '';\n      }\n    }\n    \n  }\n\n\n  async ingresar() {\n    if (!this.login || !this.password) {\n      this.toast.newCreatedToast('Debes ingresar el usuario y contraseña', false)\n      return;\n    }\n\n    const valid = this.clientes.filter((it) => it.USER == this.login && it.PASSWORD == this.password)\n\n    if (valid.length > 0) {\n\n      const insert = await this.storage.setLoginInterface({\n        login: this.login,\n        password: this.password, loc: valid[0]\n      })\n      this.user =  valid[0].Name\n      this.interface = true;\n      this.form = false;\n    } else {\n      this.toast.newCreatedToast('Las credenciales son incorrectas', false)\n\n    }\n    \n\n   \n  }\n\n\n  getInfo(guid) {\n    return new Promise((resolve, reject) => {\n      this.api.getActivitieInfo(this.tkn, guid).subscribe((data) => {\n        if (data) {\n          resolve(data)\n        } else {\n          resolve (false)\n        }\n      })\n    })\n  }\n\n\n\n  async aplicar() {\n    moment.locale('es');\n    if (!this.desde || !this.hasta) {\n      this.toast.newCreatedToast('Debes ingresar la fecha desde y hasta', false)\n      return;\n    }\n\n    console.log(this.desde, this.hasta)\n    this.load = false;\n\n    const lg = await this.storage.getLoginInterface();\n\n    this.activitiesList = [];\n\n    this.api.getActivities2(this.tkn,this.desde + ' 00:00', this.hasta + ' 23:59', 'Ld61l38tFu').subscribe(async (data : any) => {\n      console.log(data, 'data')\n      const rs = data.filter((it) => it.LocationName == lg[0].loc.Name)\n\n      for (const item of rs) {\n        let rsData: any = await this.getInfo(item.GUID)\n        rsData.creado = moment(rsData.CreatedOn).format('LL')\n        this.activitiesList.push(rsData);\n      }\n\n      this.load = true\n\n      console.log(this.activitiesList)\n    }, () => {this.load = true}) \n  }\n\n\n  download(guid) {\n    window.location.href = 'https://pdf.visitrack.com/api/PDF?AccessToken=' + this.tkn + '&GUID=' + guid;\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}