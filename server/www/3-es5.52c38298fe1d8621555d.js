function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{Rwse:function(e,t,o){"use strict";var n,i,r=o("mrSG"),a=o("VOof"),s=o("J07l"),c=o("w9U0"),l=o("AytR"),b=o("tk/3"),u=o("fXoL"),d=((n=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"upload",value:function(e,t,o,n){var i={headers:new b.d({"x-company":t,"x-type":o,"x-parent":n}),reportProgress:!0,observe:"events"};return this.http.post("".concat(l.a.URL_NODE,"/folders"),e,i)}}]),e}()).\u0275fac=function(e){return new(e||n)(u.Qb(b.a))},n.\u0275prov=u.Fb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),p=o("lJxs"),f=o("JIr8"),h=o("LRne"),g=o("TEn/"),m=o("ofXK"),y=o("3Pt+"),v=((i=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t,o){return console.log(o,e,t),t=t.toLocaleLowerCase(),e.forEach((function(e){o.find((function(t){return t===e.ID}))&&(e.checked=!0)})),""===t?e:e=e.filter((function(e){if((e.name?e.name.toLowerCase():e.Name.toLowerCase()).includes(t))return e}))}}]),e}()).\u0275fac=function(e){return new(e||i)},i.\u0275pipe=u.Ib({name:"filterUserRepository",type:i,pure:!0}),i);o.d(t,"a",(function(){return R}));var M=["fileUpload"];function C(e,t){if(1&e&&(u.Mb(0,"li"),u.Kb(1,"span",10),u.Kb(2,"ion-progress-bar",11),u.Lb()),2&e){var o=t.$implicit;u.zb(2),u.cc("value",o.progress)}}function k(e,t){if(1&e){var o=u.Nb();u.Mb(0,"div",4),u.Mb(1,"div",5),u.Mb(2,"div"),u.Mb(3,"ul"),u.kc(4,C,3,1,"li",6),u.Lb(),u.Lb(),u.Mb(5,"div"),u.Mb(6,"button",7),u.Ub("click",(function(){return u.hc(o),u.Wb(2).onClick()})),u.Mb(7,"div"),u.lc(8,"Subir Archivos"),u.Lb(),u.Lb(),u.Lb(),u.Lb(),u.Kb(9,"input",8,9),u.Lb()}if(2&e){var n=u.Wb(2);u.zb(4),u.cc("ngForOf",n.files)}}function L(e,t){if(1&e){var o=u.Nb();u.Mb(0,"ion-grid"),u.Mb(1,"ion-row"),u.Mb(2,"ion-col",12),u.Mb(3,"ion-input",13),u.Ub("ngModelChange",(function(e){return u.hc(o),u.Wb(2).folders.name=e})),u.Lb(),u.Lb(),u.Lb(),u.Mb(4,"ion-row"),u.Mb(5,"ion-col",12),u.Mb(6,"ion-textarea",14),u.Ub("ngModelChange",(function(e){return u.hc(o),u.Wb(2).folders.description=e})),u.Lb(),u.Lb(),u.Lb(),u.Mb(7,"ion-row"),u.Mb(8,"ion-col",15),u.Mb(9,"ion-button",16),u.Ub("click",(function(){return u.hc(o),u.Wb(2).cancelModal()})),u.lc(10,"CANCELAR"),u.Lb(),u.Lb(),u.Mb(11,"ion-col",15),u.Mb(12,"ion-button",17),u.Ub("click",(function(){return u.hc(o),u.Wb(2).saveFolder()})),u.lc(13,"CREAR"),u.Lb(),u.Lb(),u.Lb(),u.Lb()}if(2&e){var n=u.Wb(2);u.zb(3),u.cc("ngModel",n.folders.name),u.zb(3),u.cc("ngModel",n.folders.description)}}function w(e,t){if(1&e&&(u.Mb(0,"ion-content"),u.kc(1,k,11,1,"div",3),u.kc(2,L,14,2,"ion-grid",2),u.Lb()),2&e){var o=u.Wb();u.zb(1),u.cc("ngIf","file"===o.type),u.zb(1),u.cc("ngIf","folder"===o.type)}}function x(e,t){if(1&e){var o=u.Nb();u.Mb(0,"ion-content"),u.Mb(1,"ion-grid"),u.Mb(2,"ion-row"),u.Mb(3,"ion-col",12),u.Mb(4,"ion-input",18),u.Ub("ngModelChange",(function(e){return u.hc(o),u.Wb().category.name=e})),u.Lb(),u.Lb(),u.Lb(),u.Mb(5,"ion-row"),u.Mb(6,"ion-col",12),u.Mb(7,"ion-textarea",19),u.Ub("ngModelChange",(function(e){return u.hc(o),u.Wb().category.description=e})),u.Lb(),u.Lb(),u.Lb(),u.Mb(8,"ion-row"),u.Mb(9,"ion-col",15),u.Mb(10,"ion-button",16),u.Ub("click",(function(){return u.hc(o),u.Wb().cancelModal()})),u.lc(11,"CANCELAR"),u.Lb(),u.Lb(),u.Mb(12,"ion-col",15),u.Mb(13,"ion-button",17),u.Ub("click",(function(){return u.hc(o),u.Wb().saveCategory()})),u.lc(14,"CREAR"),u.Lb(),u.Lb(),u.Lb(),u.Lb(),u.Lb()}if(2&e){var n=u.Wb();u.zb(4),u.cc("ngModel",n.category.name),u.zb(3),u.cc("ngModel",n.category.description)}}function U(e,t){if(1&e){var o=u.Nb();u.Mb(0,"ion-item"),u.Mb(1,"ion-checkbox",24),u.Ub("ionChange",(function(e){return u.hc(o),u.Wb(2).selection(e)})),u.Lb(),u.Mb(2,"ion-label"),u.Mb(3,"strong"),u.lc(4),u.Lb(),u.Kb(5,"br"),u.Mb(6,"p"),u.lc(7,"Brindarle permisos para esta carpeta"),u.Lb(),u.Lb(),u.Lb()}if(2&e){var n=t.$implicit;u.zb(1),u.dc("value",n.ID),u.cc("checked",n.checked),u.zb(3),u.mc(n.Name)}}function T(e,t){if(1&e){var o=u.Nb();u.Mb(0,"ion-item"),u.Mb(1,"ion-checkbox",24),u.Ub("ionChange",(function(e){return u.hc(o),u.Wb(2).selection(e)})),u.Lb(),u.Mb(2,"ion-label"),u.Mb(3,"strong"),u.lc(4),u.Lb(),u.Kb(5,"br"),u.Mb(6,"p"),u.lc(7,"Brindarle permisos para esta carpeta"),u.Lb(),u.Lb(),u.Lb()}if(2&e){var n=t.$implicit;u.zb(1),u.dc("value",n.ID),u.cc("checked",n.checked),u.zb(3),u.mc(n.name)}}function P(e,t){if(1&e){var o=u.Nb();u.Mb(0,"ion-content"),u.Mb(1,"ion-list"),u.Mb(2,"ion-item",20),u.Mb(3,"ion-searchbar",21),u.Ub("ionChange",(function(e){return u.hc(o),u.Wb().filterText(e)})),u.Lb(),u.Lb(),u.Mb(4,"ion-slides",22),u.Mb(5,"ion-slide"),u.Mb(6,"ion-item-divider",23),u.Mb(7,"h4"),u.lc(8,"Usuario de mi empresa"),u.Lb(),u.Lb(),u.kc(9,U,8,3,"ion-item",6),u.Xb(10,"filterUserRepository"),u.Lb(),u.Mb(11,"ion-slide"),u.Mb(12,"ion-item-divider",23),u.Mb(13,"h4"),u.lc(14,"Clientes de mi Empresa"),u.Lb(),u.Lb(),u.kc(15,T,8,3,"ion-item",6),u.Xb(16,"filterUserRepository"),u.Lb(),u.Lb(),u.Lb(),u.Lb()}if(2&e){var n=u.Wb();u.zb(9),u.cc("ngForOf",u.Zb(10,2,n.users,n.textFilter,n.listPermiss)),u.zb(6),u.cc("ngForOf",u.Zb(16,6,n.customers,n.textFilter,n.listPermiss))}}function I(e,t){if(1&e){var o=u.Nb();u.Mb(0,"ion-footer"),u.Mb(1,"ion-toolbar",23),u.Mb(2,"ion-buttons",25),u.Mb(3,"ion-button",26),u.Ub("click",(function(){return u.hc(o),u.Wb().savePermiss()})),u.Kb(4,"ion-icon",27),u.Lb(),u.Lb(),u.Lb(),u.Lb()}}var O,R=((O=function(){function e(t,o,n,i,r){_classCallCheck(this,e),this.storage=t,this.modalCtrl=o,this.apiService=n,this.myToast=i,this.uploadService=r,this.category={name:"",description:"",company:""},this.folders={name:"",description:"",parent:""},this.users=[],this.customers=[],this.usersSelect=[],this.customer={name:"",login:"",clave:"",company:"",userID:""},this.textFilter="",this.files=[],this.count=0}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ionViewWillEnter",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initModal();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"initModal",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("permiss"!==this.type){e.next=8;break}return this.usersSelect=this.listPermiss,e.next=4,this.storage.getLogin();case 4:(t=e.sent)&&(console.log(t[0]),this.apiService.getCustomersCompany(t[0].CompanyID).subscribe((function(e){"ok"===e.status&&(e.response.length>0&&e.response.forEach((function(e){e.ID=e.login,o.customers.push(e)})),o.customers=e.response)})),this.apiService.getUsersCompany({AccessToken:t[0].AccessToken}).subscribe((function(e){e=JSON.parse(e),console.log(e),o.users=e[0],o.users=o.users.filter((function(e){return e.ID!==t[0].UserID}))}))),e.next=9;break;case 8:"alter"===this.type&&(console.log(this.categoryDatAlter,"iloves"),this.category.name=this.categoryDatAlter.name,this.category.description=this.categoryDatAlter.description);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"selection",value:function(e){e.detail.checked?this.usersSelect.push(e.detail.value):this.usersSelect=this.usersSelect.filter((function(t){return t!==e.detail.value})),console.log(this.usersSelect)}},{key:"savePermiss",value:function(){var e=this;this.apiService.alterPermiss({idCategory:this.idCategory,listPermiss:this.usersSelect}).subscribe((function(t){console.log(t),"ok"===t.status?e.myToast.newCreatedToast("Permisos actualizados para esta categoria",!0):e.myToast.newCreatedToast("No se pudo actualizar los permisos, intentelo mas tarde",!1),e.cancelModal()}))}},{key:"filterText",value:function(e){this.textFilter=e.detail.value}},{key:"uploadFile",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.storage.getLogin();case 2:(o=t.sent)&&((n=new FormData).append("archivo",e.data),e.inProgress=!0,this.uploadService.upload(n,o[0].CompanyID,"file",this.parentId).pipe(Object(p.a)((function(t){switch(t.type){case b.c.UploadProgress:e.progress=Math.round(1*t.loaded/t.total);break;case b.c.Response:return t}})),Object(f.a)((function(t){return e.inProgress=!1,Object(h.a)("".concat(e.data.name," upload failed."))}))).subscribe((function(e){"object"==typeof e&&(console.log(e.body," Respuesta"),"ok"===e.body.status?(i.count--,0===i.count&&i.modalCtrl.dismiss({status:!0,message:"Archivo subido con \xe9xito"})):i.modalCtrl.dismiss({status:!1}))})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"uploadFiles",value:function(){var e=this;this.count=this.files.length,this.fileUpload.nativeElement.value="",this.files.forEach((function(t){e.uploadFile(t)}))}},{key:"onClick",value:function(){var e=this,t=this.fileUpload.nativeElement;t.onchange=function(){for(var o=0;o<t.files.length;o++)e.files.push({data:t.files[o],inProgress:!1,progress:0});e.uploadFiles()},t.click()}},{key:"saveCategory",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.getLogin();case 2:(t=e.sent)&&("category"===this.type?(this.category.company=t[0].CompanyID,this.category.userID="inter"===t[0].type?t[0].UserID:t[0].login,this.category.listPermiss="inter"===t[0].type?[t[0].UserID]:[t[0].login],console.log(this.category),this.apiService.createdCategory(this.category).subscribe((function(e){console.log(e),e.status?(o.modalCtrl.dismiss({st:!0}),o.myToast.newCreatedToast("Categoria creada correctamente ",!0)):o.myToast.newCreatedToast("Error al crear la categoria ",!1)}),(function(e){o.myToast.newCreatedToast("Error al crear la categoria ",!1)}))):"alter"===this.type&&this.apiService.alterCategory({idCategory:this.categoryDatAlter._id,name:this.category.name,description:this.category.description}).subscribe((function(e){console.log(e),"ok"===e.status?(o.modalCtrl.dismiss({st:!0}),o.myToast.newCreatedToast("Categoria editada correctamente ",!0)):o.myToast.newCreatedToast("No se pudo editar la categoria, intentelo m\xe1s tarde ",!1)}),(function(e){o.myToast.newCreatedToast("No se pudo editar la categoria, intentelo m\xe1s tarde ",!1)})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"saveFolder",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(this.folders),this.folders.parent=this.parentId,this.apiService.createdFolder(this.folders).subscribe((function(e){console.log(e),e.status?(t.modalCtrl.dismiss({status:!0,message:"Carpeta creada con \xe9xito"}),t.myToast.newCreatedToast("Carpeta creada correctamente ",!0)):(t.modalCtrl.dismiss({status:!1}),t.myToast.newCreatedToast("Error al crear la carpeta ",!1))}),(function(e){t.myToast.newCreatedToast("Error al crear la carpeta ",!1)}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"cancelModal",value:function(){this.modalCtrl.dismiss({status:!1})}}]),e}()).\u0275fac=function(e){return new(e||O)(u.Jb(a.a),u.Jb(g.Y),u.Jb(s.a),u.Jb(c.a),u.Jb(d))},O.\u0275cmp=u.Db({type:O,selectors:[["app-category"]],viewQuery:function(e,t){var o;1&e&&u.pc(M,!0),2&e&&u.gc(o=u.Vb())&&(t.fileUpload=o.first)},inputs:{type:"type",listPermiss:"listPermiss",idCategory:"idCategory",title:"title",parentId:"parentId",categoryDatAlter:"categoryDatAlter"},decls:8,vars:5,consts:[[1,"ion-no-border"],["color","danger"],[4,"ngIf"],["style","text-align:center; margin-top: 100px; ",4,"ngIf"],[2,"text-align","center","margin-top","100px"],[2,"margin-top","10px"],[4,"ngFor","ngForOf"],[1,"myButton",3,"click"],["type","file","id","fileUpload","name","archivo","multiple","multiple",2,"display","none"],["fileUpload",""],["id","file-label"],["color","primary",3,"value"],["size","10","offset","1"],["type","text","placeholder","Nombre de la carpeta",1,"campo",3,"ngModel","ngModelChange"],["rows","5","placeholder","Descripci\xf3n de la carpeta",1,"campo",3,"ngModel","ngModelChange"],["size","4","offset","1"],["expand","block","color","light","mode","ios","shapw","round",3,"click"],["expand","block","color","danger","mode","ios","shapw","round",3,"click"],["type","text","placeholder","Nombre de la categoria",1,"campo",3,"ngModel","ngModelChange"],["rows","5","placeholder","Descripci\xf3n de la categoria",1,"campo",3,"ngModel","ngModelChange"],["lines","none"],["placeholder","Buscar Usuario","mode","ios",3,"ionChange"],[1,"slides"],["color","light"],["slot","start","color","danger",3,"checked","value","ionChange"],["slot","end"],[3,"click"],["name","add-outline","slot","icon-only"]],template:function(e,t){1&e&&(u.Mb(0,"ion-header",0),u.Mb(1,"ion-toolbar",1),u.Mb(2,"ion-title"),u.lc(3),u.Lb(),u.Lb(),u.Lb(),u.kc(4,w,3,2,"ion-content",2),u.kc(5,x,15,2,"ion-content",2),u.kc(6,P,17,10,"ion-content",2),u.kc(7,I,5,0,"ion-footer",2)),2&e&&(u.zb(3),u.mc(t.title),u.zb(1),u.cc("ngIf","file"===t.type||"folder"===t.type),u.zb(1),u.cc("ngIf","category"===t.type||"alter"===t.type),u.zb(1),u.cc("ngIf","permiss"===t.type),u.zb(1),u.cc("ngIf","permiss"===t.type))},directives:[g.s,g.T,g.S,m.i,g.l,m.h,g.D,g.r,g.J,g.k,g.u,g.fb,y.c,y.d,g.R,g.g,g.B,g.v,g.K,g.O,g.N,g.w,g.i,g.b,g.A,g.q,g.h,g.t],pipes:[v],styles:[".campo[_ngcontent-%COMP%]{width:100%;padding:5px 10px;border:1px solid rgba(0,0,0,.1);margin-bottom:10px;border-radius:10px;background:#f3f3f3}.myButton[_ngcontent-%COMP%]{width:80%;padding:10px;background:#f1f1f1;border:1px solid rgba(0,0,0,.1)}.slides[_ngcontent-%COMP%]{width:100%;min-height:100%;height:auto}.slides[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.slides[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}"]}),O)},iZCz:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var n=o("ofXK"),i=o("3Pt+"),r=o("TEn/"),a=o("BQi/"),s=o("fXoL"),c=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=s.Hb({type:e}),e.\u0275inj=s.Gb({factory:function(t){return new(t||e)},imports:[[n.b,i.a,r.U,a.a]]}),e}()}}]);