function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,s){for(var t=0;t<s.length;t++){var n=s[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,s,t){return s&&_defineProperties(e.prototype,s),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{EhdV:function(e,s,t){"use strict";t.r(s);var n=t("ofXK"),i=t("3Pt+"),o=t("TEn/"),a=t("tyNb"),r=t("mrSG"),c=t("VOof"),b=t("J07l"),l=t("HDdC"),u=t("fXoL"),g=t("7JkF");function f(e,s){if(1&e&&(u.Mb(0,"ion-col",9),u.Mb(1,"span"),u.lc(2),u.Lb(),u.Kb(3,"br"),u.Mb(4,"span"),u.lc(5),u.Lb(),u.Mb(6,"span"),u.lc(7,"Host"),u.Lb(),u.Lb()),2&e){var t=u.Wb().$implicit;u.zb(2),u.mc(t.message),u.zb(3),u.mc(t.dateMessage)}}function d(e,s){if(1&e&&(u.Mb(0,"ion-col",10),u.Mb(1,"span"),u.lc(2),u.Lb(),u.Kb(3,"br"),u.Mb(4,"span"),u.lc(5),u.Lb(),u.Lb()),2&e){var t=u.Wb().$implicit;u.zb(2),u.mc(t.message),u.zb(3),u.mc(t.dateMessage)}}function h(e,s){if(1&e&&(u.Mb(0,"ion-row"),u.kc(1,f,8,2,"ion-col",7),u.kc(2,d,6,2,"ion-col",8),u.Lb()),2&e){var t=s.$implicit,n=u.Wb();u.zb(1),u.cc("ngIf",t.idUser==n.idUser),u.zb(1),u.cc("ngIf",t.idUser!=n.idUser)}}var p,m,M=[{path:"",component:(p=function(){function e(s,t,n){var i=this;_classCallCheck(this,e),this.socket=s,this.storage=t,this.apiService=n,this.idUser="",this.listMessages=[],this.message="",this.idChat="",this.recepMessage().subscribe((function(e){console.log(e," Mi data"),new Audio("/assets/message.mp3").play(),i.listMessages.push(e.response)}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ionViewWillEnter",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadMessages(),e.next=3,this.storage.getLogin();case 3:(s=e.sent)&&(this.idUser="exter"===s[0].type?s[0].login:s[0].UserID);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"loadMessages",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var s,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.getChat();case 2:(s=e.sent)&&(this.idChat=s,this.socket.emit("entryChat",{idChat:s}),this.apiService.getOneChat(s).subscribe((function(e){"ok"===e.status&&(t.listMessages=e.response)})));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"sendMessages",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.socket.emit("sendMessage",{ID:this.idUser,parentChat:this.idChat,message:this.message}),this.listMessages.push({dateMessage:(new Date).getDate(),message:this.message,idUser:this.idUser}),this.message="";case 1:case"end":return e.stop()}}),e,this)})))}},{key:"recepMessage",value:function(){var e=this;return new l.a((function(s){e.socket.on("recepMessage",(function(e){s.next(e)}))}))}}]),e}(),p.\u0275fac=function(e){return new(e||p)(u.Jb(g.a),u.Jb(c.a),u.Jb(b.a))},p.\u0275cmp=u.Db({type:p,selectors:[["app-messages"]],decls:14,vars:2,consts:[["color","danger"],["slot","end"],["name","ellipsis-vertical-outline","slot","icon-only"],[4,"ngFor","ngForOf"],["placeholder","Escribe tu mensaje",3,"ngModel","ngModelChange"],["shape","round","mode","ios","fill","clear",3,"click"],["name","send-outline","slot","icon-only"],["offset","3","size","9","class","message verde",4,"ngIf"],["size","9","class","message",4,"ngIf"],["offset","3","size","9",1,"message","verde"],["size","9",1,"message"]],template:function(e,s){1&e&&(u.Mb(0,"ion-header"),u.Mb(1,"ion-toolbar",0),u.Mb(2,"ion-title"),u.lc(3,"Mensajeria"),u.Lb(),u.Mb(4,"ion-buttons",1),u.Mb(5,"ion-button"),u.Kb(6,"ion-icon",2),u.Lb(),u.Lb(),u.Lb(),u.Lb(),u.Mb(7,"ion-content"),u.Mb(8,"ion-grid"),u.kc(9,h,3,2,"ion-row",3),u.Lb(),u.Lb(),u.Mb(10,"ion-footer"),u.Mb(11,"ion-textarea",4),u.Ub("ngModelChange",(function(e){return s.message=e})),u.Lb(),u.Mb(12,"ion-button",5),u.Ub("click",(function(){return s.sendMessages()})),u.Kb(13,"ion-icon",6),u.Lb(),u.Lb()),2&e&&(u.zb(9),u.cc("ngForOf",s.listMessages),u.zb(2),u.cc("ngModel",s.message))},directives:[o.s,o.T,o.S,o.h,o.g,o.t,o.l,o.r,n.h,o.q,o.R,o.fb,i.c,i.d,o.J,n.i,o.k],styles:[".verde[_ngcontent-%COMP%]{background:#fbd4d4!important}.message[_ngcontent-%COMP%]{margin-top:10px;background:#e9e9e9;border-radius:20px}ion-footer[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}"]}),p)}],v=((m=function e(){_classCallCheck(this,e)}).\u0275mod=u.Hb({type:m}),m.\u0275inj=u.Gb({factory:function(e){return new(e||m)},imports:[[a.h.forChild(M)],a.h]}),m);t.d(s,"MessagesPageModule",(function(){return w}));var k,w=((k=function e(){_classCallCheck(this,e)}).\u0275mod=u.Hb({type:k}),k.\u0275inj=u.Gb({factory:function(e){return new(e||k)},imports:[[n.b,i.a,o.U,v]]}),k)}}]);